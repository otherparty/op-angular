<app-navbar></app-navbar>

<app-title class="desktop-only"></app-title>

<!-- flexbox layout -->

@if (bill) {
<div class="black">
  <div class="table-responsive wrap-1600">
    <div class="body flex flow-text lucida">
      <!-- IMAGE, TRACKING -->
      <div class="visual third padded evenly">
        <p class="mobile-only larger impact white-t">{{billSummery?.headLine}}</p>
        <div class="mobile-only">
          <span class="white-t helvetica summary-text keep-all justify"
            [innerHTML]="billSummery?.summary || billSummery?.story"></span>
        </div>
        <!-- <br> -->
        <!-- <div class="invert resize-both responsive"><img [src]="sanitize(billSummery.image)" style="max-height: 80%"
            sanitize>
        </div> -->
        <!-- <br> -->

        <!-- DESKTOP STORY -->
        <div class="desktop-only third padded evenly">
          <div class="desktop-only verbal third padded evenly">
            <p class="white-t larger impact">{{billSummery?.headLine}}</p>
            <span class="white-t helvetica keep-all summary-text justify"
              [innerHTML]="billSummery?.summary || billSummery?.story"></span>
            <!-- <br>
            <br> -->
            <p class="mint-t larger helvetica float-right">{{ bill.latest_major_action_date | date}}</p>
            <ul class="tags">
              <li>
                <span class="white-t justify smaller">{{ bill.latest_major_action }}
                </span>
              </li>
            </ul>
            @if (!user) {
            @if (bill?.showBillTextSummary) {
            <span class="white-t helvetica summary-text keep-all justify" [innerHTML]="getTruncatedSummary()"></span>
            }
            <a [routerLink]="['/register']" class="story-card__deep-link">Get it in-depth</a>
            <br>
            <div class="story-card__actions">
              <a [routerLink]="['/register']" class="story-card__cta story-card__cta--primary">Subscribe</a>
              <a [routerLink]="['/login']" class="story-card__cta story-card__cta--secondary">Login</a>
            </div>
            }

            @if (user) {
            <br>
            <div class="story-card__actions">
              <button type="button" class="story-card__cta story-card__cta--primary" (click)="openGovTrack(bill)">
                Get updates
              </button>
              @if (bill?.account?.twitter_account) {
              <button type="button" class="story-card__cta story-card__cta--secondary story-card__cta--twitter"
                (click)="openTwitter(bill?.account?.twitter_account)">
                &#64;{{bill?.account?.twitter_account}}
              </button>
              }
            </div>

            @if (bill?.showBillTextSummary) {
            <span class="white-t helvetica summary-text keep-all justify" [innerHTML]="bill?.bill_text_summary"></span>
            }
            <br>
            }
            <!-- <br>
            <br> -->
          </div>
        </div>
        <!-- MOBILE STORY -->
        <div class="mobile-only verbal third padded">
          <p class="summary-text mint-t helvetica float-right">{{ bill.latest_major_action_date | date}}</p>
          <ul class="tags">
            <li>
              <span class="white-t justify smaller">{{ bill.latest_major_action }}
              </span>
            </li>
          </ul>
          <!-- <br> -->
          <div>
          </div>

          @if (!user) {
          <div class="story-card__actions">
            <a [routerLink]="['/register']" class="story-card__cta story-card__cta--primary">Get updates</a>
            @if (bill?.account?.twitter_account) {
            <button type="button" class="story-card__cta story-card__cta--secondary story-card__cta--twitter"
              (click)="openTwitter(bill?.account?.twitter_account)">
              &#64;{{bill?.account?.twitter_account}}
            </button>
            }
          </div>

          @if (bill?.showBillTextSummary) {
          <span class="white-t helvetica summary-text keep-all justify" [innerHTML]="getTruncatedSummary()"></span>
          }

          <a [routerLink]="['/register']" class="story-card__deep-link">Get it in-depth</a>

          <div class="story-card__actions">
            <a [routerLink]="['/register']" class="story-card__cta story-card__cta--primary">Subscribe</a>
            <a [routerLink]="['/login']" class="story-card__cta story-card__cta--secondary">Login</a>
          </div>
          }
          <br>
          <!-- LOGGED IN -->
          @if (user) {
          @if (bill?.showBillTextSummary) {
          <span class="white-t helvetica summary-text keep-all justify" [innerHTML]="bill?.bill_text_summary"></span>
          }

          <div class="story-card__actions">
            <button type="button" class="story-card__cta story-card__cta--primary" (click)="openGovTrack(bill)">
              Get updates
            </button>
            @if (bill?.account?.twitter_account) {
            <button type="button" class="story-card__cta story-card__cta--secondary story-card__cta--twitter"
              (click)="openTwitter(bill?.account?.twitter_account)">
              &#64;{{bill?.account?.twitter_account}}
            </button>
            }
          </div>
          }
        </div>
      </div>

    </div>
  </div>
</div>
<app-content></app-content>
}

<!-- TODO: Create separate component -->
@if(isError) {
<div class="black">
  <div class="wrap-1600 table-responsive">

    <div class="flex flow-text lucida">
      <!-- two columns -->
      <div class="half padded evenly infinitile">
        <!-- <p class="helvetica larger">Dairy Innovation</p> -->
        <div class="resize-both responsive"><img [src]="sanitize(fallbackImage)" style="max-height: 80%" sanitize>
        </div>
        <p class="spacer"></p>
      </div>
      <div class="half padded">
        <p class="helvetica larger neon-text">404 Error: Missing Bill</p>
        <br>
        <span class="helvetica keep-all flow-text justify">
          <!-- we realize we've delved into uncharted legislative realms. Our robotic allies are diligently scouring for
        answers. In the interim, let's retreat to familiar ground. Home beckons, offering respite amidst uncertainty. As
        we await resolution, let's regroup, recharge, and strategize our next steps. Together, we'll navigate this
        unfamiliar terrain with caution and resolve. Our journey may be unpredictable, but with perseverance and
        collaboration, we'll overcome any obstacle that stands in our path. -->
        </span>
        <p class="spacer"></p>
        <p class="spacer"></p>
        <p class="spacer"></p>
        <button class="flood btn-medium bitshadow" (click)="fallbackHome()">
          Go Back Home</button>
        <br>
        <br>
      </div>
    </div>
  </div>
</div>
<app-content></app-content>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="spacer"></p>
}

@if (isLoading) {
<div class="loading">
  <p class="spacer"></p>
  Loading....
  <p class="spacer"></p>
  <p class="spacer"></p>
</div>
}

<app-footer></app-footer>